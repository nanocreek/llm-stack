apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: llm-stack

bases:
  - ../../base

namePrefix: dev-

commonLabels:
  env: development
  managed-by: skaffold

# Configure image replacement to work with skaffold's image tagging
# Skaffold will replace these with actual built image digests/tags
images:
  - name: llm-stack/react-client
    newName: llm-stack/react-client
  - name: llm-stack/r2r
    newName: llm-stack/r2r
  - name: llm-stack/qdrant
    newName: llm-stack/qdrant
  - name: llm-stack/litellm
    newName: llm-stack/litellm
  - name: llm-stack/openwebui
    newName: llm-stack/openwebui

secretGenerator:
  - name: litellm-secret
    literals:
      - master-key=sk-dev-master-key-12345678901234567890
      - openai-api-key=sk-proj-dev-key-test
      - anthropic-api-key=sk-ant-dev-key-test

patchesJson6902:
  - target:
      group: apps
      version: v1
      kind: Deployment
      name: react-client
    patch: |-
      - op: replace
        path: /spec/template/spec/containers/0/imagePullPolicy
        value: IfNotPresent
  - target:
      group: apps
      version: v1
      kind: Deployment
      name: r2r
    patch: |-
      - op: replace
        path: /spec/template/spec/containers/0/imagePullPolicy
        value: IfNotPresent
  - target:
      group: apps
      version: v1
      kind: Deployment
      name: qdrant
    patch: |-
      - op: replace
        path: /spec/template/spec/containers/0/imagePullPolicy
        value: IfNotPresent
  - target:
      group: apps
      version: v1
      kind: Deployment
      name: litellm
    patch: |-
      - op: replace
        path: /spec/template/spec/containers/0/imagePullPolicy
        value: IfNotPresent
  - target:
      group: apps
      version: v1
      kind: Deployment
      name: openwebui
    patch: |-
      - op: replace
        path: /spec/template/spec/containers/0/imagePullPolicy
        value: IfNotPresent
